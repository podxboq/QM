\chapter{Formulación mecánica Lagrangiana}


\section{El lagrangiano del sistema}

El lagrangiano es una aplicación escalar definida sobre un cierto espacio de posibles estados del sistema, donde dicho sistema viene determinado en cada momento por la posición y velocidad de cada uno de sus componentes.

El espacio de estados es una variedad diferenciable construida como el fibrado tangente $T\mathcal{M}$ de una variedad $\mathcal{M}$ y el lagrangiano es una función de la forma $\maps{L}{\mathcal{M}\times T\mathcal{M}\times\R}{\R}$.

Para la física clásica, el lagrangiano de un sistema, se forma mediante la energía cinética ($T$) y la energía potencial ($V$) de tal manera que:
\begin{postulate}[Lagrangiano clásico en base a la energía]
    \begin{equation}
        \label{eq:lagrangiano_clasico}
        L(x,\dot{x},t)=T-V=\frac{1}{2}m\dot{x}(t)^2-V(x,t)
    \end{equation}
\end{postulate}


\section{Acción de un funcional}
\begin{definition}
    Sea $\maps{L}{\R^n\times\R^n\times\R}{\R}$ una aplicación real y $\maps{\alpha}{I=[t_0, t_1]}{\R^n}$ una función real, definimos el funcional \define{acción de L}{acción} a:
    \begin{equation}
        \label{eq:accion}
        \begin{split}
            \mapsdef{S_L}{\mathscr{C}(I, \R^n)}{R}{\alpha}{\int_{I}L(\alpha(t), \dot{\alpha}(t), t)\ dt}
        \end{split}
    \end{equation}
\end{definition}

\begin{theorem}
    En los términos de la definición \eqref{eq:accion}, el funcional $S_L$ es diferenciable en $\alpha$ y su valor es
    \begin{equation}
        \label{eq:accion_diferencial}
        \begin{align}
            \mapsdef{dS_L(\alpha)}{\mathscr{C}(I, \R^n)}{R}{h}{\int_{I}\left( \frac{\partial L}{\partial\alpha}h+\frac{\partial L}{\partial\dot{\alpha}}\dot{h}\right) dt}
        \end{align}
    \end{equation}
\end{theorem}
\begin{proof}
    Por la definición de diferencial y realizando el desarrollo de Taylor tenemos que
    \begin{equation*}
        \begin{split}
            S_L(\alpha + h) -  S_L(\alpha)& = \int_{I}L(\alpha(t)+h(t), \dot{\alpha}(t)+\dot{h}(t), t)\ dt - \int_{I}L(\alpha(t), \dot{\alpha}(t), t)\ dt =\\
            &\by{\ref{eq:polinomio-taylor-dos-variables}}\int_{I}\left( \frac{\partial L}{\partial\alpha}h+\frac{\partial L}{\partial\dot{\alpha}}\dot{h}\right)\ dt+\mathcal{O}(h^2)\so\\
            dS_L(\alpha)(h) &=\int_{I}\left( \frac{\partial L}{\partial\alpha}h+\frac{\partial L}{\partial\dot{\alpha}}\dot{h}\right) dt
        \end{split}
    \end{equation*}
\end{proof}


\section{Ecuación de Euler-Lagrange}

\begin{theorem}
    Una función real $\alpha$ alcanza un valor extremo (máximo o mínimo) en el funcional $S_L$ sí y sólo sí se da la siguiente igualdad llamada \define{ecuación de Euler-Lagrange}{Ecuación de Euler-Lagrange}
    \begin{equation}
        \label{eq:euler-lagrange}
        \frac{\partial L}{\partial \alpha}=\frac{d}{dt}\left( \frac{\partial L}{\partial \dot{\alpha}} \right)
    \end{equation}
\end{theorem}
\begin{proof}
    Una función alcanza un valor máximo o mínimo en el funcional $S_L$ cuando su diferencial se hace cero, es decir, que $dS_L(\alpha)(h)=0$ para cualquier función $h$.
    \begin{equation*}
        \begin{split}
            0 = dS_L(\alpha)(h) &\by{\ref{eq:accion_diferencial}}\int_{I}\left( \frac{\partial L}{\partial\alpha}h+\frac{\partial L}{\partial\dot{\alpha}}\dot{h}\right) dt = \int_{I}\left( \frac{\partial L}{\partial\alpha}h+\frac{d}{dt}\left( \frac{\partial L}{\partial \dot{\alpha}}h \right)-\frac{d}{dt}\left( \frac{\partial L}{\partial \dot{\alpha}} \right)h\right)\ dt = \\
            & = \int_{I}\left( \frac{\partial L}{\partial \alpha}h-\frac{d}{dt}\left( \frac{\partial L}{\partial \dot{\alpha}} \right)h\right)\ dt +\int_{I}\frac{d}{dt}\left( \frac{\partial L}{\partial \dot{\alpha}}h \right)\ dt = \\
            & =\colorequation{1}{blue}{\int_I\left( \frac{\partial L}{\partial \alpha}-\frac{d}{dt}\left( \frac{\partial L}{\partial \dot{\alpha}} \right)\right)h\ dt} + \colorequation {2}{green}{\left[ \frac{\partial L}{\partial \dot{\alpha}}h \right]_{t_0}^{t_1}}
        \end{split}
    \end{equation*}
    En particular si nos restringimos a las funciones $h$ que cumplen $h(t_0)=0=h(t_1)$, el sumando \refcolorequation[green]{2} vale $0$ y el para el sumando \refcolorequation[blue]{1} tenemos que
    \begin{equation*}
        \int_{I}\left( \frac{\partial L}{\partial \alpha}-\frac{d}{dt}\left( \frac{\partial L}{\partial \dot{\alpha}} \right)\right)h\ dt = 0 \so \frac{\partial L}{\partial \alpha}-\frac{d}{dt}\left( \frac{\partial L}{\partial \dot{\alpha}} \right) = 0
    \end{equation*}
\end{proof}

\begin{definition}
    Llamaremos \define{trayectorias}{Trayectoria} a las funciones que cumplen la ecuación de Euler-Lagrange \eqref{eq:euler-lagrange}.
\end{definition}


\section{Principio de mínima acción}

El principio de mínima acción o principio de Hamilton, es un postulado básico de la física para describir la evolución a lo largo del tiempo del estado de movimiento de una partícula.

El \textbf{principio de mínima acción} o \textbf{principio de Hamilton}, dice que las partículas se mueven a traves de trayectorias que minimizan la acción del lagrangiano.


\section{Energía}
La energía de un sistema es la suma de la energía cinética y la energía potencial $E=K+V$, si ponemos esta expresión en terminos del lagrangiano, tenemos que $E=T+V=T+(T-L)=2T-L$.

Es fácil comprobar que $\frac{\partial L}{\partial\dot{\alpha}}\dot{\alpha}=m\dot{\alpha}^2=2T$, obteniendo las siguientes expresiones de la energía:
\begin{equation}
    \label{eq:energia_lagrangiana}
    E(\alpha, \dot{\alpha})=L(\alpha, \dot{\alpha})+m\dot{\alpha}^2=\frac{\partial L}{\partial\dot{\alpha}}\dot{\alpha}-L
\end{equation}


\section{Las leyes de Newton a través del lagrangiano}
La tercera ley de Newton, dice que la fuerza es la masa por la aceleración, como la fuerza viene regida por el potencial $-\frac{\partial V}{\partial\alpha}$ y la aceleración es la variación de la velocidad, la tercera ley de Newton queda en:
\begin{equation*}
    -\frac{\partial V}{\partial\alpha} = m\frac{d\dot{\alpha}}{dt}
\end{equation*}
Ahora tenemos las siguientes igualdades:
\begin{subequations}
    \begin{equation*}
        L=\frac{1}{2}m\dot{\alpha}^2-V(\alpha).
    \end{equation*}
    \begin{equation*}
        \frac{\partial L}{\partial \alpha}=-\frac{\partial V}{\partial \alpha}
    \end{equation*}
    \begin{equation*}
        \frac{\partial L}{\partial\dot{\alpha}}=m\dot{\alpha}
    \end{equation*}
\end{subequations}


\section{Teorema de Noether}

Sean $\maps{\alpha,\beta}{I=[t_0, t_1]}{\R^n}$ dos funciones, tales que los lagrangianos para ambas trayectorias está relacionado por $L(\beta, \dot{\beta}, t) = L(\alpha, \dot{\alpha}, t)+\dot{f}$ para alguna función $f$.
Entonces las respectivas acciones están relacionadas por una constante, pues

\begin{equation}
    \label{eq:variacion-accion}
    \begin{split}
        S_L(\beta) & = \int_I L(\beta, \dot{\beta}, t) dt = \int_I L(\alpha, \dot{\alpha}, t)\ dt+\int_I \dot{f}dt=S_L(\alpha) +[f]_{t_0}^{t_1}
    \end{split}
\end{equation}

Y por tanto sus diferenciales son iguales.
Así que en particular, si $\alpha$ es una trayectoria, también lo es $\beta$ y ademas tenemos que

\begin{equation}
    \label{eq:diferencial_trayectoria}
    \begin{split}
    [f]
        _{t_0}^{t_1} &= S_L(\beta) - S_L(\alpha) = S_L(\alpha + (\beta-\alpha))-S_L(\alpha)=dS_L(\alpha)(\beta-\alpha)=\\
        &\by{\ref{eq:accion_diferencial}}\int_{I}\left( \frac{\partial L}{\partial\alpha}(\beta-\alpha)+\frac{\partial L}{\partial\dot{\alpha}}(\dot{\beta}-\dot{\alpha})\right) dt\by{\ref{eq:euler-lagrange}}\int_{I}\left( \frac{d}{dt}\left(\frac{\partial L}{\partial\dot{\alpha}}\right)(\beta-\alpha)+\frac{\partial L}{\partial\dot{\alpha}}(\dot{\beta}-\dot{\alpha})\right) dt=\\
        &=\int_{I}\frac{d}{dt}\left(\frac{\partial L}{\partial\dot{\alpha}}(\beta-\alpha)\right) dt = \frac{\partial L}{\partial\dot{\alpha}}(\beta-\alpha) + \text{ cte }
    \end{split}
\end{equation}

Es decir, que para trayectorias cuyos lagrangianos se diferencia por la diferencial de una función, existe una constante $\ct{C}$ tal que
\begin{equation}
    \label{eq:flujo_noether_para_trayectorias}
    \frac{\partial L}{\partial\dot{\alpha}}(\beta-\alpha) = \ct{C}
\end{equation}

\begin{definition}
    Dadas dos trayectorias $\maps{\alpha,\beta}{I}{\R^n}$, llamamos \define{flujo de Noether}{Flujo de Noether} de $\alpha$ a $\beta$ a
    \begin{equation}
        \label{eq:flujo_noether}
        \frac{\partial L}{\partial\dot{\alpha}}(\beta-\alpha)
    \end{equation}
\end{definition}

\begin{theorem}[Teorema de Noether~\eqref{thm:noether}]
    \label{thm:noether}
    Si la acción de un sistema con lagrangiano $L$ es invariante bajo la transformación de $\alpha$ a $\beta$ tal que $L_\beta=L_\alpha+\dot{f}$ entonces el flujo de Noether de $\alpha$ a $\beta$, permanece constante.
\end{theorem}


\chapter{Simetrías y cantidades conservadas}
Cuando el lagrangiano de un sistema tiene una simetría $\sigma$, éste se mantiene invariante tras aplicar la simetría, y por tanto, toda trayectoria $\alpha$ es equivalente a $\sigma(\alpha)$, y estamos en condiciones de aplicar el teorema de Noether~\ref{thm:noether} y afirmar por tanto que el flujo de Noether de $\alpha$ a $\sigma(\alpha)$ es constante.


\section{Homogeneidad del espacio y conservación del momento lineal}
Es lógico pensar que las ecuaciones de la física no varien según el lugar del espacio elegido, por eso, un cambio de coordenadas del tipo $\beta=\alpha+p_0$ donde $p_0\in\R^n$ debe dejar invariante el lagrangiano y dejar el flujo de Noether constante, es decir
\begin{equation}
    \label{eq:conservacion_momento_lineal}
    \frac{\partial L}{\partial\dot{\alpha}}(\beta-\alpha) = \frac{\partial L}{\partial\dot{\alpha}}p_0=\text{cte}\so\frac{\partial L}{\partial\dot{\alpha}}=\text{cte}
\end{equation}


\section{Isotropía del espacio y conservación del momento angular}
Es lógico pensar que las ecuaciones de la física no varien según la orientación elegida, por eso, una rotación en un plano del tipo $\beta=\alpha + (\alpha\times s)$ donde $s$ es un vector sobre el eje de rotación, debe dejar invariante el lagrangiano y dejar el flujo de Noether constante, es decir
\begin{equation}
    \label{eq:conservacion_momento_angular}
    \frac{\partial L}{\partial\dot{\alpha}}(\beta-\alpha) = \frac{\partial L}{\partial\dot{\alpha}}(\alpha\times s) = s \frac{\partial L}{\partial\dot{\alpha}}\times \alpha=\text{cte}\so\frac{\partial L}{\partial\dot{\alpha}}\times \alpha=\text{cte}
\end{equation}


\section{Homogeneidad del tiempo y conservación de la energía}
Es lógico pensar que las leyes de la física no varian con el tiempo, esto nos obliga a exigir que el lagrangiano de un sistema sea el mismo con respecto al tiempo, así pues, debemos tener que $\dot{L}=0$.
Aplicando la regla de la cadena tenemos:
\begin{equation*}
    \dot{L}=\frac{dL(\alpha, \dot{\alpha})}{dt}=\frac{\partial L}{\partial \alpha}\frac{d\alpha}{dt}+\frac{\partial L}{\partial \dot{\alpha}}\frac{d\dot{\alpha}}{dt}\by{\ref{eq:euler-lagrange}}\frac{d}{dt}\left(\frac{\partial L}{\partial \dot{\alpha}}\right)\dot{\alpha}+\frac{\partial L}{\partial \dot{\alpha}}\frac{d\dot{\alpha}}{dt}=\frac{d}{dt}\left(\frac{\partial L}{\partial \dot{\alpha}}\dot{\alpha}\right)\by{\ref{eq:energia_lagrangiana}}\frac{d}{dt}\left(E+L\right)=\dot{E}+\dot{L}
\end{equation*}
La igualdad anterior nos lleva a la expresión $\dot{E}=0$, es decir, la energía no varía con el tiempo.
